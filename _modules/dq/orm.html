
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>dq.orm &#8212; dqpy 1.2 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for dq.orm</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="k">import</span> <span class="n">uuid4</span>

<span class="kn">import</span> <span class="nn">arrow</span>
<span class="kn">import</span> <span class="nn">redis</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="k">import</span> <span class="n">as_declarative</span>
<span class="kn">from</span> <span class="nn">sqlalchemy_utils</span> <span class="k">import</span> <span class="n">ArrowType</span>

<span class="kn">from</span> <span class="nn">dq.config</span> <span class="k">import</span> <span class="n">Config</span>
<span class="kn">from</span> <span class="nn">dq.database</span> <span class="k">import</span> <span class="n">query_with_limit_offset</span><span class="p">,</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">dq.logging</span> <span class="k">import</span> <span class="n">error</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">SERVICE_NAME</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;meta.name&#39;</span><span class="p">)</span>

<span class="c1"># An attribute of a model. The order is the following:</span>
<span class="c1"># - name (string): The name of the attribute (the key)</span>
<span class="c1"># - allow_from (boolean): Whether the attribute can be inflated with incoming</span>
<span class="c1">#       dictionaries. Default is True.</span>
<span class="c1"># - allow_to (boolean): Whether the attribute can be exported to outgoing</span>
<span class="c1">#       dictionaries. Default is True.</span>
<span class="c1"># - serializer (function): The function that processes the attribute value</span>
<span class="c1">#       before converting to dictionary. Default is None (no-op).</span>
<span class="c1"># - deserializer (function): The function that processes the dictionary value</span>
<span class="c1">#       before converting to the object attribute. Default is None (no-op).</span>
<span class="n">Attr</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Attr&#39;</span><span class="p">,</span> <span class="s1">&#39;name allow_from allow_to serializer deserializer&#39;</span><span class="p">)</span>
<span class="n">Attr</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__defaults__</span> <span class="o">=</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<div class="viewcode-block" id="uuid4_string"><a class="viewcode-back" href="../../index.html#dq.orm.uuid4_string">[docs]</a><span class="k">def</span> <span class="nf">uuid4_string</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return a UUID as string.</span>

<span class="sd">    The UUID type must NOT be used anywhere in the app - only use string.</span>
<span class="sd">    This function should be used whenever a new UUID is needed.</span>

<span class="sd">    :returns string: A UUID string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span></div>


<div class="viewcode-block" id="arrow_in"><a class="viewcode-back" href="../../index.html#dq.orm.arrow_in">[docs]</a><span class="k">def</span> <span class="nf">arrow_in</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert an arrow-understandable time to an Arrow object.</span>

<span class="sd">    :param value: The arrow-understandable time or ``None``.</span>
<span class="sd">    :returns Arrow: The Arrow object, or ``None`` if the input is ``None``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">arrow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="arrow_out"><a class="viewcode-back" href="../../index.html#dq.orm.arrow_out">[docs]</a><span class="k">def</span> <span class="nf">arrow_out</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert an Arrow object to timestamp.</span>

<span class="sd">    :param Arrow value: The Arrow time or ``None``.</span>
<span class="sd">    :returns int: The timestamp, or ``None`` if the input is ``None``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">timestamp</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="boolean_mask"><a class="viewcode-back" href="../../index.html#dq.orm.boolean_mask">[docs]</a><span class="k">def</span> <span class="nf">boolean_mask</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mask a value to boolean. This can be used for sensitive fields.</span>

<span class="sd">    :param value: Any value.</span>
<span class="sd">    :returns boolean: The input value casted to boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="enum_value"><a class="viewcode-back" href="../../index.html#dq.orm.enum_value">[docs]</a><span class="k">def</span> <span class="nf">enum_value</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert an enum to its value.</span>

<span class="sd">    :param Enum value: An enum.</span>
<span class="sd">    :returns string: The value of the enum.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="DictMixin"><a class="viewcode-back" href="../../index.html#dq.orm.DictMixin">[docs]</a><span class="k">class</span> <span class="nc">DictMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dictionary mixin that provides converters to/from Python dicts.</span>

<span class="sd">    See comments of ``Attr`` above for defining fields to convert with this</span>
<span class="sd">    mixin.</span>

<span class="sd">    This class is inherited by ``IDBase`` and ``UUIDBase`` classes, so your</span>
<span class="sd">    class will not need to inherit directly from it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__attrs__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>

<div class="viewcode-block" id="DictMixin.to_dict"><a class="viewcode-back" href="../../index.html#dq.orm.DictMixin.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert an object to dictionary.</span>

<span class="sd">        :returns dict: The dictionary converted from the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__attrs__</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">allow_to</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">name</span>
            <span class="n">out</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">serializer</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">serializer</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="DictMixin.to_json"><a class="viewcode-back" href="../../index.html#dq.orm.DictMixin.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert an object to JSON string.</span>

<span class="sd">        :returns string: The JSON string representation of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span></div>

<div class="viewcode-block" id="DictMixin.inflate_to_dict"><a class="viewcode-back" href="../../index.html#dq.orm.DictMixin.inflate_to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">inflate_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert an object to dictionary, with relationships inflated.</span>

<span class="sd">        This method is the default implementation, which simply calls the</span>
<span class="sd">        ``to_dict`` method. Subclasses willing to inflate certain fields should</span>
<span class="sd">        override this method.</span>

<span class="sd">        :param Session session: The optional SQL session.</span>
<span class="sd">        :returns dict: The dictionary converted from the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></div>

<div class="viewcode-block" id="DictMixin.from_dict"><a class="viewcode-back" href="../../index.html#dq.orm.DictMixin.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert a dictionary to an object.</span>

<span class="sd">        :param dict data: The data dictionary.</span>
<span class="sd">        :returns Base: The object converted from the dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">entity</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">entity</span><span class="o">.</span><span class="n">__attrs__</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">allow_from</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">deserializer</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">deserializer</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">attr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">entity</span></div></div>


<div class="viewcode-block" id="TimeMixin"><a class="viewcode-back" href="../../index.html#dq.orm.TimeMixin">[docs]</a><span class="k">class</span> <span class="nc">TimeMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Time fields common to all models.</span>

<span class="sd">    This class is inherited by ``IDBase`` and ``UUIDBase`` classes, so your</span>
<span class="sd">    class will not need to inherit directly from it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">created_at</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">ArrowType</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">arrow</span><span class="o">.</span><span class="n">utcnow</span><span class="p">)</span>
    <span class="n">updated_at</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">ArrowType</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">arrow</span><span class="o">.</span><span class="n">utcnow</span><span class="p">,</span>
                        <span class="n">onupdate</span><span class="o">=</span><span class="n">arrow</span><span class="o">.</span><span class="n">utcnow</span><span class="p">)</span>
    <span class="n">deleted_at</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">ArrowType</span><span class="p">)</span></div>


<div class="viewcode-block" id="Cache"><a class="viewcode-back" href="../../index.html#dq.orm.Cache">[docs]</a><span class="k">class</span> <span class="nc">Cache</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Redis cache engine. This should not be used externally!</span>

<span class="sd">    This is a separate Redis connection from the one in the redis package. The</span>
<span class="sd">    purpose is twofold:</span>

<span class="sd">    1. The cache Redis does not allow response decoding, but the user Redis</span>
<span class="sd">       requires it.</span>
<span class="sd">    2. By separating the two, if a project does not have an explicit cache</span>
<span class="sd">       configuration, then cache can be effectively disabled globally.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_instance</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_attempted</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Cache.instance"><a class="viewcode-back" href="../../index.html#dq.orm.Cache.instance">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_attempted</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">cachecfg</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cache&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cachecfg</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_attempted</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">StrictRedis</span><span class="p">(</span><span class="o">**</span><span class="n">cachecfg</span><span class="p">)</span>
            <span class="c1"># This will attempt to connect to Redis and throw an error if the</span>
            <span class="c1"># connection is invalid.</span>
            <span class="n">i</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">return</span> <span class="n">i</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="s1">&#39;Unable to connect to cache Redis&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_attempted</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Cache.get"><a class="viewcode-back" href="../../index.html#dq.orm.Cache.get">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value corresponding to the key in the cache.</span>

<span class="sd">        :param string key: The cache key.</span>
<span class="sd">        :returns bytes: The cache value in raw bytes if exists. If the key does</span>
<span class="sd">            not exist or if cache server cannot be reached, returns ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="s1">&#39;Error querying cache&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">})</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Cache.set"><a class="viewcode-back" href="../../index.html#dq.orm.Cache.set">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ttl</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">i</span><span class="o">.</span><span class="n">setex</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ttl</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">error</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="s1">&#39;Error setting cache&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">})</span></div></div>


<div class="viewcode-block" id="QueryMixin"><a class="viewcode-back" href="../../index.html#dq.orm.QueryMixin">[docs]</a><span class="k">class</span> <span class="nc">QueryMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Query helper functions useful to all models.</span>

<span class="sd">    This class is inherited by ``IDBase`` and ``UUIDBase`` classes, so your</span>
<span class="sd">    class will not need to inherit directly from it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="QueryMixin.cache_key"><a class="viewcode-back" href="../../index.html#dq.orm.QueryMixin.cache_key">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">cache_key</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">contains_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.cache.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">SERVICE_NAME</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__tablename__</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">contains_deleted</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">+=</span> <span class="s1">&#39;.del&#39;</span>
        <span class="k">if</span> <span class="n">contains_empty</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">+=</span> <span class="s1">&#39;.empty&#39;</span>
        <span class="k">return</span> <span class="n">key</span></div>

<div class="viewcode-block" id="QueryMixin.get_cache"><a class="viewcode-back" href="../../index.html#dq.orm.QueryMixin.get_cache">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_cache</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">contains_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the object from cache.&quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">cache_key</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="n">contains_deleted</span><span class="p">,</span>
                            <span class="n">contains_empty</span><span class="o">=</span><span class="n">contains_empty</span><span class="p">)</span>
        <span class="n">cached</span> <span class="o">=</span> <span class="n">Cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">cached</span><span class="p">)</span> <span class="k">if</span> <span class="n">cached</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="QueryMixin.save_to_cache"><a class="viewcode-back" href="../../index.html#dq.orm.QueryMixin.save_to_cache">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">save_to_cache</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
                      <span class="n">contains_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">contains_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">cache_key</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="n">contains_deleted</span><span class="p">,</span>
                            <span class="n">contains_empty</span><span class="o">=</span><span class="n">contains_empty</span><span class="p">)</span>
        <span class="n">Cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ttl</span><span class="p">)</span></div>

<div class="viewcode-block" id="QueryMixin.get_by"><a class="viewcode-back" href="../../index.html#dq.orm.QueryMixin.get_by">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_by</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">contains_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="n">fresh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the object satisfying the query condition.</span>

<span class="sd">        :param string column: The name of the column to query by.</span>
<span class="sd">        :param string value: The value of the column to query for.</span>
<span class="sd">        :param boolean contains_deleted: Whether to contain deleted records.</span>
<span class="sd">            Default is ``False`` and only active records are returned.</span>
<span class="sd">        :param boolean contains_empty: Whether to contain empty records.</span>
<span class="sd">            Default is ``False`` and if value is ``None``, ``None`` will be</span>
<span class="sd">            returned.</span>
<span class="sd">        :param int ttl: The TTL of cache. If &lt; 0, no cache will be used.</span>
<span class="sd">        :param boolean fresh: Whether to fetch the response fresh from the DB.</span>
<span class="sd">        :param Session session: Optional SQL session.</span>
<span class="sd">        :returns QueryMixin: The matching object. This method is designed for</span>
<span class="sd">            unique queries and in case of multiple matches, only the first one</span>
<span class="sd">            is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contains_empty</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">ttl</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fresh</span><span class="p">:</span>
            <span class="n">cached</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_cache</span><span class="p">(</span>
                <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="n">contains_deleted</span><span class="p">,</span>
                <span class="n">contains_empty</span><span class="o">=</span><span class="n">contains_empty</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cached</span>

        <span class="n">session</span> <span class="o">=</span> <span class="n">session</span> <span class="ow">or</span> <span class="n">Session</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">args</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">contains_deleted</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;deleted_at&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">and</span> <span class="n">ttl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">save_to_cache</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="n">ttl</span><span class="p">,</span>
                              <span class="n">contains_deleted</span><span class="o">=</span><span class="n">contains_deleted</span><span class="p">,</span>
                              <span class="n">contains_empty</span><span class="o">=</span><span class="n">contains_empty</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="QueryMixin.get_multi"><a class="viewcode-back" href="../../index.html#dq.orm.QueryMixin.get_multi">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_multi</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">sort_column</span><span class="o">=</span><span class="s1">&#39;updated_at&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get multiple objects satisfying the query condition.</span>

<span class="sd">        :param string column: The name of the column to query by.</span>
<span class="sd">        :param string value: The value of the column to query for.</span>
<span class="sd">        :param string sort_column: The column to sort results against. Default</span>
<span class="sd">            is updated_at. Please note that created_at usually doesn&#39;t have</span>
<span class="sd">            index, so if it should be used as the sort column, an index needs</span>
<span class="sd">            to be added.</span>
<span class="sd">        :param bool desc: Whether to sort DESC. Default is ``True``.</span>
<span class="sd">        :param int offset: The query offset. Default is 0.</span>
<span class="sd">        :param int limit: The max number of results to return. Default is 10.</span>
<span class="sd">            If specified, the function will try to fetch one more result to</span>
<span class="sd">            indicate whether there are more results. If not specified or 0, all</span>
<span class="sd">            results will be returned.</span>
<span class="sd">        :param Session session: The optional SQL session to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">session</span> <span class="o">=</span> <span class="n">session</span> <span class="ow">or</span> <span class="n">Session</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;deleted_at&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="n">args</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sort_column</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">sort_column</span><span class="p">)</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span> <span class="k">if</span> <span class="n">desc</span> <span class="k">else</span> <span class="n">q</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">attr</span><span class="o">.</span><span class="n">asc</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">query_with_limit_offset</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="UserRelationMixin"><a class="viewcode-back" href="../../index.html#dq.orm.UserRelationMixin">[docs]</a><span class="k">class</span> <span class="nc">UserRelationMixin</span><span class="p">(</span><span class="n">QueryMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin that provides a common ``get_by_user`` function.</span>

<span class="sd">    This mixin should be used by classes that a user can have a 1-many</span>
<span class="sd">    relationship to, such as orders, shipments, and periods.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The key used for sorting (DESC) when getting by user. This is most likely</span>
    <span class="c1"># a time field such as created_at or updated_at.</span>
    <span class="n">sort_key</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="UserRelationMixin.get_by_user"><a class="viewcode-back" href="../../index.html#dq.orm.UserRelationMixin.get_by_user">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_by_user</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the related object of a user.</span>

<span class="sd">        :param string/int user_id: The ID (if int) or UUID (if string) of the</span>
<span class="sd">            user.</span>
<span class="sd">        :param bool desc: Whether to sort DESC. Default is ``True``.</span>
<span class="sd">        :param integer offset: The offset of the objects. If limit is 10 and</span>
<span class="sd">            offset is 5, the function will attempt to get the 6th to 15th</span>
<span class="sd">            most recent objects.</span>
<span class="sd">        :param integer limit: The max number of objects to get.</span>
<span class="sd">        :param Session session: The optional SQL session.</span>
<span class="sd">        :returns list&lt;UserRelationMixin&gt;: The list of objects matching the</span>
<span class="sd">            requirement.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">column</span> <span class="o">=</span> <span class="s1">&#39;user_id&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;user_uuid&#39;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_multi</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">sort_key</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">,</span>
                             <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span></div></div>


<span class="nd">@as_declarative</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">IDBase</span><span class="p">(</span><span class="n">QueryMixin</span><span class="p">,</span> <span class="n">DictMixin</span><span class="p">,</span> <span class="n">TimeMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for an ORM model with numeric ID as the primary key.&quot;&quot;&quot;</span>

    <span class="n">__attrs__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Attr</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">allow_to</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="n">fresh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an object by its ID.</span>

<span class="sd">        :param int id: The ID of the object.</span>
<span class="sd">        :param boolean contains_deleted: Whether to contain deleted objects.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        :param int ttl: Cache TTL in seconds. If &lt;= 0 no cache will be used.</span>
<span class="sd">            Default is 3600 (1 hour).</span>
<span class="sd">        :param boolean fresh: Whether to fetch a fresh copy even if cache</span>
<span class="sd">            exists. Default is ``False``.</span>
<span class="sd">        :param Session session: Optional SQL session to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_by</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="n">contains_deleted</span><span class="p">,</span>
                          <span class="n">fresh</span><span class="o">=</span><span class="n">fresh</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>


<span class="nd">@as_declarative</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">UUIDBase</span><span class="p">(</span><span class="n">QueryMixin</span><span class="p">,</span> <span class="n">DictMixin</span><span class="p">,</span> <span class="n">TimeMixin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for an ORM model with UUID as the primary key.&quot;&quot;&quot;</span>

    <span class="n">__attrs__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Attr</span><span class="p">(</span><span class="s1">&#39;uuid&#39;</span><span class="p">,</span> <span class="n">allow_to</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">uuid</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">uuid4_string</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="n">fresh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">session</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an object by its UUID.</span>

<span class="sd">        :param string uuid: The UUID of the object.</span>
<span class="sd">        :param boolean contains_deleted: Whether to contain deleted objects.</span>
<span class="sd">            Default is ``False``.</span>
<span class="sd">        :param int ttl: Cache TTL in seconds. If &lt;= 0 no cache will be used.</span>
<span class="sd">            Default is 3600 (1 hour).</span>
<span class="sd">        :param boolean fresh: Whether to fetch a fresh copy even if cache</span>
<span class="sd">            exists. Default is ``False``.</span>
<span class="sd">        :param Session session: Optional SQL session to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_by</span><span class="p">(</span><span class="s1">&#39;uuid&#39;</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">contains_deleted</span><span class="o">=</span><span class="n">contains_deleted</span><span class="p">,</span>
                          <span class="n">fresh</span><span class="o">=</span><span class="n">fresh</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy; 2018 Danqing Liu.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    
    <a href="https://github.com/danqing/dqpy" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>